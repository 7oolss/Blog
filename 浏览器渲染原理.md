### 浏览器的组成:
> - UI(用户界面) - 指浏览器的外在表现样式(包括地址栏、书签目录等,也就是所看到的除用来显示主窗口外的其他部分);
> - Browser Engine(浏览器引擎) - 连接UI和渲染引擎;
> - Rendering Engine(渲染引擎) - 根据请求内容进行不同的渲染,HTML和CSS分别使用对应的Parser;
> - Networking(网络) - 用来完成网络请求，如http请求等，它具有与平台无关的接口，可以在不同平台上工作;
> - UI backend(UI后端) - 用来生成一些基础控件，如窗口、对话框,控件也是跨平台的，会调用系统本身的方法来生成对应的控件;
> - JavaScript Interpreter(JS解释器) - 用于解释及执行JS代码;
> - Data Storage(数据存储) - 属于持久层,用于存储数据,包含存储本地的cookies及类似localstoragr等存储机制的数据;

> ![](http://www.nowamagic.net/librarys/images/201404/2014_04_04_02.png)

### 如何渲染一个网页?
> 1. 浏览器地址栏输入要访问你网页的url
> 2. 浏览器解析url,得到其指定的协议、主机、端口及路径
> 3. 浏览器通过DNS查询,将域名转换为IP
> 4. 浏览器开启对应的通信端口与解析得到的IP地址进行通信
> 5. 建立连接后,向目标主机发送http请求,请求中包含一些浏览器基本属性及网页参数
> 6. 目标主机接收请求并转发给监听对应端口的服务器
> 7. 服务器解析请求路径,根据配置交给对应的处理器处理
> 8. 处理请求,根据不同情况,可能需要连接数据库获取数据来构建回应内容
> 9. 将数据整合成回应主体,用包含必要信息的header封装请求体,以同样的协议返回给用户浏览器
> 10. 浏览器解析请求体(检测状态码)
> 11. 以html为例,浏览器解析html,生成DOM树
> 12. 针对其内引用的外部资源逐个发起请求获取,如js,css,图片等,即重复上述步骤
> 13. 浏览器接收到样式后开始解析内容,css构建CSSOM,根据具体的属性来执行js的解析
> 14. 针对更新后的DOM和CSSOM,生成render tree,即包含了视觉展示信息的树,浏览器根据render tree进行渲染
> 15. 根据css对render tree进行layout定位(此步骤称为定位或布局),然后对定位好的部分进行Painting(绘制),至此页面加载完成.

### 渲染主流程:
> 1. ```解析HTML以构建DOM树``` ：渲染引擎开始解析HTML文档,转换树中的html标签或js生成的标签到DOM节点,它被称为 - 内容树
> 2. ```构建渲染树```：解析CSS(包括外部CSS文件、样式元素、js生成的样式),根据CSS选择器计算出节点的样式,创建另一个树 - 渲染树
> 3. ```布局渲染树```：从根节点递归调用,计算每一个元素的大小、位置等,给每个节点所应该出现在屏幕上的精确坐标. - reflow
> 4. ```绘制渲染树```：遍历渲染树,每个节点将使用UI后端层来绘制 - repaint

### Webkit 渲染引擎工作方式图解:
> ![](http://taligarsiel.com/Projects/webkitflow.png)
